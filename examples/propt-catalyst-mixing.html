<!-- Dyna-to-Html Version 1.6 - Copyright (c) 2018-2021 Alain J. Michiels. All rights reserved. -->
<html>
<head>
<style>
body {font-family: Verdana, Geneva, sans-serif; font-size: 14px; background-color: white;}
p {margin-left: 14px;}
ol {margin-top: -10px; margin-left: 15px; padding-left: 15px;}
ul {margin-top: -10px; margin-left: 15px; padding-left: 15px;}
pre {display: block; font-family: monospace; white-space: pre; margin: 1em 0; font-size: 16px;}
ol.ref {margin-top: -10px; margin-left: 36px; padding-left: 0; text-indent: -22px; list-style-position: outside; list-style-type: none; counter-reset: icnt;}
ol.ref li.ref::before {content: '[' counter(icnt) '] '; counter-increment: icnt;}
</style>
<script async="" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML" type="text/javascript"></script>
<meta http-equiv="Content-Type" content="text/html;charset=ISO-8859-1">
</head>
<body>
<h1 align="center" style="color:#7EAEAC">Catalyst Mixing</h1>
<pre>
<font color="red"><b>rem:</b></font> Catalyst Mixing
</pre>
<p>
  This problem considers a plug-flow reactor, packed with two catalysts,
  involving the reactions.
<p>
  \[
  S_1 \leftrightarrow S_2 \rightarrow S_3
  \]
<p>
  The optimal mixing policy of the two catalysts has to be determined in order
  to maximize the production of species S3. This dynamic optimization problem
  was originally proposed by Gunn and Thomas (1965), and subsequently
  considered by Logsdon (1990) and Vassiliadis (1993). The mathematical
  formulation is:
<p>
  Maximize:
  \[
  J = 1 - x_1(t_f) - x_2(t_f)
  \]
  subject to:
  \[
  \dot{x}_1 = u \ (10 \ x_2-x_1) \\
  \dot{x}_2 = u \ (x_1-10 \ x_2)-(1-u) \ x_2 \\
  0 \leq u \leq 1 \\
  x(t_0) = [1 \ 0] \\
  t_f = 1
  \]
<p>
  Reference:
  <ol>
  <li>V.S. Vassiliadis, E. Balsa-Canto, J.R. Banga,
  <em>Second-order sensitivities of general dynamic systems with application to optimal control problems</em>,
  Chemical Engineering Science, 54(17):3851-3860, September 1999.
  </ol>
<p>
  Source: PROPT - Matlab Optimal Control Software, User Manual, April 26, 2010.
<p>
<pre>
<font color="red"><b>par:</b></font>
  tf = 1

<font color="red"><b>dyn:</b></font>
  x1 x2	<font color="#808080"><i># state variables</i></font>
  u	<font color="#808080"><i># control variable</i></font>

<font color="red"><b>lim:</b></font>
  0.9 &lt;= x1 &lt;= 1
  0 &lt;= x2 &lt;= 0.1
  0 &lt;= u &lt;= 1

<font color="red"><b>t=t0:</b></font>
  x1 = 1
  x2 = 0

<font color="red"><b>t=tf:</b></font>
  x1 &lt;= 0.95

<font color="red"><b>ini:</b></font>
  x1 = <font color="#0074D9">linspace</font>(1,0.915)
  x2 = <font color="#0074D9">linspace</font>(0,0.05)
  u = <font color="#0074D9">linspace</font>(1,0)

<font color="red"><b>equ:</b></font>
  x1&acute; == u*(10*x2-x1)
  x2&acute; == u*(x1-10*x2)-(1-u)*x2

<font color="red"><b>obj:</b></font>
  <font color="#8A2BE2">maximize</font> 1-<font color="#0074D9">final</font>(x1)-<font color="#0074D9">final</font>(x2) <font color="#8A2BE2">using</font> nlp
</pre>
</body>
</html>
