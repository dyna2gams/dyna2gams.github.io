<!-- Dyna-to-Html Version 1.1 - Copyright (c) 2018 Alain J. Michiels. All rights reserved. -->
<html>
<head>
<style>
body {font-family: Verdana, Geneva, sans-serif; font-size: 14px; background-color: white;}
p {margin-left: 14px;}
ol {margin-top: -10px; margin-left: 15px; padding-left: 15px;}
ul {margin-top: -10px; margin-left: 15px; padding-left: 15px;}
pre {display: block; font-family: monospace; white-space: pre; margin: 1em 0; font-size: 16px;}
ol.ref {margin-top: -10px; margin-left: 36px; padding-left: 0; text-indent: -22px; list-style-position: outside; list-style-type: none; counter-reset: icnt;}
ol.ref li.ref::before {content: '[' counter(icnt) '] '; counter-increment: icnt;}
</style>
<script async="" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML" type="text/javascript"></script>
<meta http-equiv="Content-Type" content="text/html;charset=ISO-8859-1">
</head>
<body>
<h1 align="center" style="color:#7EAEAC">Nonlinear Continuous Stirred Tank Reactor</h1>
<pre>
<font color="red"><b>rem:</b></font> Nonlinear Continuous Stirred Tank Reactor
</pre>
<p>
  The problem was first introduced by Jensen (1964) and consists of determining
  the four optimal controls of a chemical reactor in order to obtain maximum
  economic benefit. The system dynamics describe four simultaneous chemical
  reactions taking place in an isothermal continuous stirred tank reactor. The
  controls are the flow rates of three feed streams and an electrical energy
  input used to promote a photochemical reaction. Luus (1990) and Bojkov,
  Hansel, and Luus (1993) considered two sub-cases using three and four control
  variables respectively. The problem is formulated as follows:
<p>
  Find \(u_1(t)\), \(u_2(t)\), \(u_3(t)\) and \(u_4(t)\) over \(t \in [t_0,t_f]\) to maximize:
  \[
  J = x_8(t_f)
  \]
  subject to:
  \[
  \dot{x}_1 = u_4 - q \ x_1 - 17.6 \ x_1 \ x_2 - 23 \ x_1 \ x_6 \ u_3 \\
  \dot{x}_2 = u_1 - q \ x_2 - 17.6 \ x_1 \ x_2 - 146 \ x_2 \ x_3 \\
  \dot{x}_3 = u_2 - q \ x_3 - 73 \ x_2 \ x_3 \\
  \dot{x}_4 =  - q \ x_4 + 35.2 \ x_1 \ x_2 - 51.3 \ x_4 \ x_5 \\
  \dot{x}_5 =  - q \ x_5 + 219 \ x_2 \ x_3 - 51.3 \ x_4 \ x_5 \\
  \dot{x}_6 =  - q \ x_6 + 102.6 \ x_4 \ x_5 - 23 \ x_1 \ x_6 \ u_3 \\
  \dot{x}_7 =  - q \ x_7 + 46 \ x_1 \ x_6 \ u_3 \\
  \dot{x}_8 = 5.8 \ (q \ x_1 - u_4) - 3.7 \ u_1 - 4.1 \ u_2 + q \ (23 \ x_4 + 11 \ x_5 + 28 \ x_6 + 35 \ x_7) - 5 \ u_3^2 - 0.099
  \]
  where:
  \[
  q = u_1 + u_2 + u_4
  \]
  with the initial conditions:
  \[
  x(t_0) = [0.1883 \ \ 0.2507 \ \ 0.0467 \ \ 0.0899 \ \ 0.1804 \ \ 0.1394 \ \ 0.1046 \ \ 0.000]
  \]
  and the following bounds on the control variables:
  \[
  0 \leq u_1 \leq 20 \\
  0 \leq u_2 \leq 6 \\
  0 \leq u_3 \leq 4 \\
  0 \leq u_4 \leq 20
  \]
  The final time is considered fixed as \(t_f = 0.2\).
<p>
  Reference:
  <ol>
  <li>Eva Balsa-Canto, Julio R. Banga, Antonio A. Alonso, Vassilios S. Vassiliadis,
  <em>Dynamic optimization of chemical and biochemical processes using restricted second-order information</em>,
  Computers & Chemical Engineering, Volume 25, Issues 4-6, 1 May 2001, Pages 539-546.
  </ol>
<p>
  Source: PROPT - Matlab Optimal Control Software, User Manual, April 26, 2010
<p>
<pre>
<font color="red"><b>par:</b></font>
  tf = 0.2

<font color="red"><b>dyn:</b></font>
  x{1:8}	<font color="#808080"><i># state variables</i></font>
  u{1:4}	<font color="#808080"><i># control variables</i></font>

<font color="red"><b>lim:</b></font>
  0 &lt;= x{1:8} &lt;= +<font color="#3D9970">inf</font>
  0 &lt;= u1 &lt;= 20
  0 &lt;= u2 &lt;= 6
  0 &lt;= u3 &lt;= 4
  0 &lt;= u4 &lt;= 20

<font color="red"><b>t=t0:</b></font>
  x1 = 0.1883
  x2 = 0.2507
  x3 = 0.0467
  x4 = 0.0899
  x5 = 0.1804
  x6 = 0.1394
  x7 = 0.1064
  x8 = 0

<font color="red"><b>ini:</b></font>
  x1 = 0.1883
  x2 = 0.2507
  x3 = 0.0467
  x4 = 0.0899
  x5 = 0.1804
  x6 = 0.1394
  x7 = 0.1064
  x8 = 0

<font color="red"><b>exp:</b></font>
  q == u1 + u2 + u4

<font color="red"><b>equ:</b></font>
  x1&acute; == u4 - q*x1 - 17.6*x1*x2 - 23*x1*x6*u3
  x2&acute; == u1 - q*x2 - 17.6*x1*x2 - 146*x2*x3
  x3&acute; == u2 - q*x3 - 73*x2*x3
  x4&acute; == - q*x4 + 35.2*x1*x2 - 51.3*x4*x5
  x5&acute; == - q*x5 + 219*x2*x3 - 51.3*x4*x5
  x6&acute; == - q*x6 + 102.6*x4*x5 - 23*x1*x6*u3
  x7&acute; == - q*x7 + 46*x1*x6*u3
  x8&acute; == 5.8*(q*x1-u4) - 3.7*u1 - 4.1*u2 + q*(23*x4+11*x5+28*x6+35*x7) - 5*<font color="#2ECC40">sqr</font>(u3) - 0.099	<font color="#808080"><i># 4.1*u2+(u1+u2*u4) in another paper, -0.09 instead of -0.099</i></font>

<font color="red"><b>obj:</b></font>
  <font color="#8A2BE2">maximize</font> <font color="#0074D9">final</font>(x8) <font color="#8A2BE2">using</font> nlp
</pre>
</body>
</html>
