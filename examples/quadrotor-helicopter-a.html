<!-- Dyna-to-Html Version 1.4 - Copyright (c) 2018 Alain J. Michiels. All rights reserved. -->
<html>
<head>
<style>
body {font-family: Verdana, Geneva, sans-serif; font-size: 14px; background-color: white;}
p {margin-left: 14px;}
ol {margin-top: -10px; margin-left: 15px; padding-left: 15px;}
ul {margin-top: -10px; margin-left: 15px; padding-left: 15px;}
pre {display: block; font-family: monospace; white-space: pre; margin: 1em 0; font-size: 16px;}
ol.ref {margin-top: -10px; margin-left: 36px; padding-left: 0; text-indent: -22px; list-style-position: outside; list-style-type: none; counter-reset: icnt;}
ol.ref li.ref::before {content: '[' counter(icnt) '] '; counter-increment: icnt;}
</style>
<script async="" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML" type="text/javascript"></script>
<meta http-equiv="Content-Type" content="text/html;charset=ISO-8859-1">
</head>
<body>
<h1 align="center" style="color:#7EAEAC">Trajectory Optimisation for a Quadrotor Helicopter</h1>
<pre>
<font color="red"><b>rem:</b></font> Trajectory Optimisation for a Quadrotor Helicopter
</pre>
<p>
  In this example we deal with the limitation of embedded energy for quadrotor unmanned aerial
  vehicles. Quadrotor UAVs are flying machines that use lift generated by several rotors, and
  because of this, a large proportion of their available energy is consumed by rotors in order to
  maintain the vehicle in the air.
<p>
  Two optimal control problems are formulated and solved. For the first problem, minimum-energy
  control effort is computed for desired initial and final configurations with respect to the
  angular velocity of rotors. Where in the second, minimum time control effort is computed for a
  desired energy.
<p>
  Reference:
  <ol>
  <li>F. Yacef, N. Rizoug, L. Degaa, O. Bouhali and M. Hamerlain,
  <em>Trajectory Optimisation for a Quadrotor Helicopter Considering Energy Consumption</em>,
  Proceedings of 2017 4th International Conference on Control, Decision and Information Technologies,
  Barcelona, Spain. April 5-7, 2017.
  </ol>
<p>
<pre>
<font color="red"><b>par:</b></font>
  Ir = 4.1904e-5	<font color="#808080"><i># rotor inertia [kg.m²]</i></font>
  Dv = 0.2e-3		<font color="#808080"><i># viscous damping coefficient of the motor [N.m.s/rad]</i></font>
  m = 1.3		<font color="#808080"><i># mass of the quadrotor flying vehicle [kg]</i></font>
  I{x y z} = {0.081 0.081 0.142}	<font color="#808080"><i># inertia [kg.m²]</i></font>
  l = 0.175		<font color="#808080"><i># distance from the centre of mass to the rotor shaft [m]</i></font>
  g = 9.81		<font color="#808080"><i># acceleration due to gravity [m/s²]</i></font>
  kapb = 3.8305e-6	<font color="#808080"><i># thrust factor [N/rad/s]</i></font>
  kapt = 2.2518e-8	<font color="#808080"><i># drag coefficient [N.m/rad/s]</i></font>
  c2{1:4} = {-1.72e-5 1.95e-5 -6.98e-6 4.09e-7}
  c1{1:4} = {0.014 -0.0157 5.656e-3 -3.908e-4}
  c0{1:4} = {-0.8796 0.3385 0.2890 0.1626}
  tf = 10

<font color="red"><b>dyn:</b></font>
  x y z			<font color="#808080"><i># absolute position of the quadrotor</i></font>
  phi theta psi		<font color="#808080"><i># Euler angles: roll, pitch, yaw: rotation around {x y z}-axis</i></font>
  w{1:4}		<font color="#808080"><i># rotational rate of the motors</i></font>
  dw{1:4}		<font color="#808080"><i># control variables: acceleration of the motors  </i></font>
  vx vy vz
  dphi dtheta dpsi
  J

<font color="red"><b>lim:</b></font>
  -pi/2 &lt;= phi &lt;= pi/2
  -pi/2 &lt;= theta &lt;= pi/2
  0 &lt;= w{1:4} &lt;= 1200
  -750 &lt;= dw{1:4} &lt;= 750

<font color="red"><b>t=t0:</b></font>
  {x y z} = 0
  {vx vy vz} = 0
  {phi theta psi} = 0
  {dphi dtheta dpsi} = 0
  w{1:4} = 912.32
  J = 0

<font color="red"><b>t=tf:</b></font>
  {x y z} = {4 5 6}
  {vx vy vz} = 0
  {phi theta psi} = 0
  {dphi dtheta dpsi} = 0

<font color="red"><b>exp:</b></font>
  w == w1 - w2 + w3 - w4
  T == kapb*(<font color="#2ECC40">sqr</font>(w1)+<font color="#2ECC40">sqr</font>(w2)+<font color="#2ECC40">sqr</font>(w3)+<font color="#2ECC40">sqr</font>(w4))
  u1 == kapb*(<font color="#2ECC40">sqr</font>(w2)-<font color="#2ECC40">sqr</font>(w4))
  u2 == kapb*(<font color="#2ECC40">sqr</font>(w3)-<font color="#2ECC40">sqr</font>(w1))
  u3 == kapt*(<font color="#2ECC40">sqr</font>(w1)-<font color="#2ECC40">sqr</font>(w2)+<font color="#2ECC40">sqr</font>(w3)-<font color="#2ECC40">sqr</font>(w4))
  tg{1:4} == Ir*dw{1:4} + kapt*<font color="#2ECC40">sqr</font>(w{1:4}) + Dv*w{1:4}		<font color="#808080"><i># torque generated by motor</i></font>
  eff{1:4} == <font color="#0074D9">Poly3</font>(tg{1:4},a{1:4},b{1:4},c{1:4},d{1:4})	<font color="#808080"><i># efficiency of the brushless dc motor</i></font>
  a{1:4} == <font color="#0074D9">Poly2</font>(w{1:4},c21,c11,c01)
  b{1:4} == <font color="#0074D9">Poly2</font>(w{1:4},c22,c12,c02)
  c{1:4} == <font color="#0074D9">Poly2</font>(w{1:4},c23,c13,c03)
  d{1:4} == <font color="#0074D9">Poly2</font>(w{1:4},c24,c14,c04)

<font color="red"><b>equ:</b></font>
  x&acute; == vx
  y&acute; == vy
  z&acute; == vz
  m*vx&acute; == (<font color="#2ECC40">cos</font>(phi)*<font color="#2ECC40">sin</font>(theta)*<font color="#2ECC40">cos</font>(psi) + <font color="#2ECC40">sin</font>(phi)*<font color="#2ECC40">sin</font>(psi))*T
  m*vy&acute; == (<font color="#2ECC40">cos</font>(phi)*<font color="#2ECC40">sin</font>(theta)*<font color="#2ECC40">sin</font>(psi) - <font color="#2ECC40">sin</font>(phi)*<font color="#2ECC40">cos</font>(psi))*T
  m*vz&acute; == <font color="#2ECC40">cos</font>(phi)*<font color="#2ECC40">cos</font>(theta)*T - m*g
  phi&acute; == dphi
  theta&acute; == dtheta
  psi&acute; == dpsi
  Ix*dphi&acute; == (Iy-Iz)*dtheta*dpsi + Ir*dtheta*w + l*u1
  Iy*dtheta&acute; == (Iz-Ix)*dphi*dpsi - Ir*dphi*w + l*u2
  Iz*dpsi&acute; == (Ix-Iy)*dphi*dtheta + u3
  w{1:4}&acute; == dw{1:4}
  J&acute; == <font color="#3D9970">sum</font>{1:4, tg{:}*w{:}/eff{:}} + 1e-4*<font color="#3D9970">sum</font>{1:4, <font color="#2ECC40">sqr</font>(dw{:})}

<font color="red"><b>ini:</b></font>
  {x y z} = <font color="#0074D9">linspace</font>(<font color="#0074D9">initial</font>(x),<font color="#0074D9">final</font>(x))
  w{1:4} = <font color="#0074D9">initial</font>(w{1:4})

<font color="red"><b>obj:</b></font>
  <font color="#8A2BE2">minimize</font> <font color="#0074D9">final</font>(J) <font color="#8A2BE2">using</font> nlp
</pre>
</body>
</html>
